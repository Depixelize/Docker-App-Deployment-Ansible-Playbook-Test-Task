<source>
  @type tail
  path /fluentd/log/access.log
  pos_file /fluentd/log/access.log.pos
  tag nginx.access
  format ltsv
  time_format %d/%b/%Y:%H:%M:%S %z
</source>

<filter nginx.access>
  @type parser
  key_name log
  format ltsv
</filter>

<match nginx.access>
  @type copy
  <store>
    @type mysql_bulk
    host 10.0.0.5
    database log_db
    username root
    password very_secret
    table log_table
    flush_interval 10s
    column_names 'timestamp, request_time, upstream_time, remote_addr, remote_user, time_local, request, status, body_bytes_sent, http_referer, http_user_agent, geoip_country_code'
  </store>
</match>
